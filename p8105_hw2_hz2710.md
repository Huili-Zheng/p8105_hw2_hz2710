p8105\_hw2\_hz2710
================
Huili Zheng
10/7/2021

## Problem 1

Read and clean the Mr. Trash Wheel sheet:

``` r
wheel_df = 
  read_excel("data/Trash-Wheel-Collection-Totals-8-6-19.xlsx",range = "A2:N406" ) %>%
  janitor::clean_names() %>%
  drop_na("dumpster") %>%
  mutate(
    sports_balls = round(sports_balls)
  ) 
```

Read and clean precipitation data for 2018 and 2019.

``` r
pre2018_df = 
  read_excel("data/Trash-Wheel-Collection-Totals-8-6-19.xlsx",
             sheet = "2018 Precipitation",
             range = "A2:B14") %>%
  janitor::clean_names() %>%
  drop_na("total") %>%
  mutate(
    year = 2018
  )
pre2019_df = 
  read_excel("data/Trash-Wheel-Collection-Totals-8-6-19.xlsx",
             sheet = "2019 Precipitation",
             range = "A2:B14") %>%
  janitor::clean_names() %>%
  drop_na("total") %>%
  mutate(
    year = 2019
  )

pre_df = 
  left_join(pre2018_df, pre2019_df, by = "month") %>%
  mutate(
    mouth = month.name[month]
  )
```

The number of observations in Mr.Trash Wheel dataset is 344 and the
number of observations in precipitation data is 12. The key variables of
Mr.Trash Wheel dataset include “weight\_tons” and
“volume\_cubic\_yards”. The key variables of precipitation data are
“month” and “total”. The total precipitation in 2018 is 70.33. The
median number of sports balls in a dumpster in 2019 is 8.5.

Problem 2 This problem uses the FiveThirtyEight data; these data were
gathered to create the interactive graphic on this page. In particular,
we’ll use the data in pols-month.csv, unemployment.csv, and snp.csv. Our
goal is to merge these into a single data frame using year and month as
keys across datasets.

First, clean the data in pols-month.csv.

``` r
pols_month_df = 
  read_csv("data/fivethirtyeight_datasets/pols-month.csv") %>%
  janitor::clean_names() %>%
  separate(mon, into = c('year', 'month', 'day'), sep = "-") %>%
  mutate(
    year = as.integer(year),
    month = month.name[as.integer(month)],
    day = as.integer(day),
    president = case_when(prez_gop == 1 ~ "gop" ,
                          prez_dem == 1 ~ "dem"),
  ) %>%
  select(-c(day, prez_dem, prez_gop))
```

    ## Rows: 822 Columns: 9

    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## dbl  (8): prez_gop, gov_gop, sen_gop, rep_gop, prez_dem, gov_dem, sen_dem, r...
    ## date (1): mon

    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

Second, clean the data in snp.csv using a similar process to the above.

``` r
snp_df = 
  read_csv("data/fivethirtyeight_datasets/snp.csv") %>%
  janitor::clean_names() %>%
  mutate(date = mdy(date)) %>%
  separate(date, into = c('year', 'month', 'day'),sep = "-") %>%
  mutate(
    year = as.integer(year),
    month = month.name[as.integer(month)],
  ) %>%
  relocate(year, month) %>%
  select(-(day))
```

    ## Rows: 787 Columns: 2

    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## chr (1): date
    ## dbl (1): close

    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

Third, tidy the unemployment data so that it can be merged with the
previous datasets.

``` r
unemployment_df = 
  read.csv("data/fivethirtyeight_datasets/unemployment.csv") %>%
  janitor::clean_names() %>%
  pivot_longer(jan:dec, names_to = "month", values_to = "unemployment rate") %>%
  mutate(
    month = case_when(month == "jan" ~ "1",
                      month == "feb" ~ "2",
                      month == "mar" ~ "3",
                      month == "apr" ~ "4",
                      month == "may" ~ "5",
                      month == "jun" ~ "6",
                      month == "jul" ~ "7",
                      month == "aug" ~ "8",
                      month == "sep" ~ "9",
                      month == "oct" ~ "10",
                      month == "nov" ~ "11",
                      month == "dec" ~ "12"),
    month = month.name[as.integer(month)]
  )
```

Join the datasets by merging snp into pols, and merging unemployment
into the result.

``` r
result_df = left_join(left_join(snp_df,pols_month_df,by = c("year","month")), unemployment_df, by = c("month","year"))
```

The pols-month dataset contains the number of governors, senators,
representatives from republican and democratic parties from 1947 to 2015
and specifies the party the presidents were on the associated date. The
snp dataset contains the closing value of the S&P stock index on the
associated date. The unemployment dataset contains the every month
unemployment rate in the associated year. The dimension of result
dataset is 787 rows and 11 columns. The range of years is -99, the names
of key variables are “year” and “month”.
