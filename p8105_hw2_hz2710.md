p8105\_hw2\_hz2710
================
Huili Zheng
10/7/2021

## Problem 1

Read and clean the Mr. Trash Wheel sheet:

``` r
wheel_df = 
  read_excel("data/Trash-Wheel-Collection-Totals-8-6-19.xlsx",range = "A2:N406" ) %>%
  janitor::clean_names() %>%
  drop_na("dumpster") %>%
  mutate(
    sports_balls = round(sports_balls)
  ) 
```

Read and clean precipitation data for 2018 and 2019.

``` r
pre2018_df = 
  read_excel("data/Trash-Wheel-Collection-Totals-8-6-19.xlsx",
             sheet = "2018 Precipitation",
             range = "A2:B14") %>%
  janitor::clean_names() %>%
  drop_na("total") %>%
  mutate(
    year = 2018
  )
pre2019_df = 
  read_excel("data/Trash-Wheel-Collection-Totals-8-6-19.xlsx",
             sheet = "2019 Precipitation",
             range = "A2:B14") %>%
  janitor::clean_names() %>%
  drop_na("total") %>%
  mutate(
    year = 2019
  )

pre_df = 
  left_join(pre2018_df, pre2019_df, by = "month") %>%
  mutate(
    mouth = month.name[month]
  )
```

The number of observations in Mr.Trash Wheel dataset is 344 and the
number of observations in precipitation data is 12. The key variables of
Mr.Trash Wheel dataset include “weight\_tons” and
“volume\_cubic\_yards”. The key variables of precipitation data are
“month” and “total”. The total precipitation in 2018 is 70.33. The
median number of sports balls in a dumpster in 2019 is 8.5.

Problem 2 This problem uses the FiveThirtyEight data; these data were
gathered to create the interactive graphic on this page. In particular,
we’ll use the data in pols-month.csv, unemployment.csv, and snp.csv. Our
goal is to merge these into a single data frame using year and month as
keys across datasets.

First, clean the data in pols-month.csv. Use separate() to break up the
variable mon into integer variables year, month, and day; replace month
number with month name; create a president variable taking values gop
and dem, and remove prez\_dem and prez\_gop; and remove the day
variable.

``` r
pols_month_df = 
  read_csv("data/fivethirtyeight_datasets/pols-month.csv") %>%
  janitor::clean_names() %>%
  separate(mon, into = c('year', 'month', 'day'), sep = "-") %>%
  mutate(
    year = as.integer(year),
    month = month.name[as.integer(month)],
    day = as.integer(day),
    president = case_when(prez_gop == 1 ~ "gop" ,
                          prez_dem == 1 ~ "dem"),
  ) %>%
  select(-c(day, prez_dem, prez_gop))
```

    ## Rows: 822 Columns: 9

    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## dbl  (8): prez_gop, gov_gop, sen_gop, rep_gop, prez_dem, gov_dem, sen_dem, r...
    ## date (1): mon

    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

Second, clean the data in snp.csv using a similar process to the above.
For consistency across datasets, arrange according to year and month,
and organize so that year and month are the leading columns.

``` r
snp_df = 
  read_csv("data/fivethirtyeight_datasets/snp.csv") %>%
  janitor::clean_names() %>%
  separate(date, into = c('month', 'day', 'year'),sep = "/") %>%
  mutate(
    year = as.integer(year),
    month = month.name[as.integer(month)],
  ) %>%
  relocate(year, month) %>%
  select(-(day))
```

    ## Rows: 787 Columns: 2

    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## chr (1): date
    ## dbl (1): close

    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

Third, tidy the unemployment data so that it can be merged with the
previous datasets. This process will involve switching from “wide” to
“long” format; ensuring that key variables have the same name; and
ensuring that key variables take the same values.

``` r
unemployment_df = 
  read.csv("data/fivethirtyeight_datasets/unemployment.csv") %>%
  janitor::clean_names() %>%
  pivot_longer(jan:dec, names_to = "month", values_to = "unemployment rate") %>%
  mutate(
    month = case_when(month == "jan" ~ "1",
                      month == "feb" ~ "2",
                      month == "mar" ~ "3",
                      month == "apr" ~ "4",
                      month == "may" ~ "5",
                      month == "jun" ~ "6",
                      month == "jul" ~ "7",
                      month == "aug" ~ "8",
                      month == "sep" ~ "9",
                      month == "oct" ~ "10",
                      month == "nov" ~ "11",
                      month == "dec" ~ "12"),
    month = month.name[as.integer(month)]
  )
```

Join the datasets by merging snp into pols, and merging unemployment
into the result.

``` r
result_df = left_join(left_join(snp_df,pols_month_df,by = c("year","month")), unemployment_df, by = c("month","year"))
```

Write a short paragraph about these datasets. Explain briefly what each
dataset contained, and describe the resulting dataset (e.g. give the
dimension, range of years, and names of key variables).

Note: we could have used a date variable as a key instead of creating
year and month keys; doing so would help with some kinds of plotting,
and be a more accurate representation of the data. Date formats are
tricky, though. For more information check out the lubridate package in
the tidyverse.
